<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Trophic ecology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="trophic_ecology_files/libs/clipboard/clipboard.min.js"></script>
<script src="trophic_ecology_files/libs/quarto-html/quarto.js"></script>
<script src="trophic_ecology_files/libs/quarto-html/popper.min.js"></script>
<script src="trophic_ecology_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="trophic_ecology_files/libs/quarto-html/anchor.min.js"></script>
<link href="trophic_ecology_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="trophic_ecology_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="trophic_ecology_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="trophic_ecology_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="trophic_ecology_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sections</h2>
   
  <ul>
  <li><a href="#representativeness-of-the-sampling-baseline-variation-krill" id="toc-representativeness-of-the-sampling-baseline-variation-krill" class="nav-link active" data-scroll-target="#representativeness-of-the-sampling-baseline-variation-krill">1. Representativeness of the sampling + baseline variation (krill)</a>
  <ul class="collapse">
  <li><a href="#krill-data" id="toc-krill-data" class="nav-link" data-scroll-target="#krill-data">Krill data</a></li>
  <li><a href="#sampling" id="toc-sampling" class="nav-link" data-scroll-target="#sampling">Sampling</a></li>
  </ul></li>
  <li><a href="#isotopic-diversity-index" id="toc-isotopic-diversity-index" class="nav-link" data-scroll-target="#isotopic-diversity-index">2. Isotopic diversity index</a>
  <ul class="collapse">
  <li><a href="#formatting-of-data-and-calculation-of-relative-biomasses-within-each-depth-layer" id="toc-formatting-of-data-and-calculation-of-relative-biomasses-within-each-depth-layer" class="nav-link" data-scroll-target="#formatting-of-data-and-calculation-of-relative-biomasses-within-each-depth-layer">Formatting of data and calculation of relative biomasses within each depth layer</a></li>
  <li><a href="#definitions" id="toc-definitions" class="nav-link" data-scroll-target="#definitions">Definitions:</a></li>
  <li><a href="#calculation-of-indices-within-each-depth-layer" id="toc-calculation-of-indices-within-each-depth-layer" class="nav-link" data-scroll-target="#calculation-of-indices-within-each-depth-layer">Calculation of indices within each depth layer</a>
  <ul class="collapse">
  <li><a href="#epipelagic" id="toc-epipelagic" class="nav-link" data-scroll-target="#epipelagic">Epipelagic</a></li>
  <li><a href="#upper-mesopelagic" id="toc-upper-mesopelagic" class="nav-link" data-scroll-target="#upper-mesopelagic">Upper-mesopelagic</a></li>
  <li><a href="#lower-mesopelagic" id="toc-lower-mesopelagic" class="nav-link" data-scroll-target="#lower-mesopelagic">Lower-mesopelagic</a></li>
  <li><a href="#bathypelagic" id="toc-bathypelagic" class="nav-link" data-scroll-target="#bathypelagic">Bathypelagic</a></li>
  </ul></li>
  <li><a href="#evolution-of-trophic-diversity-indices-with-depth" id="toc-evolution-of-trophic-diversity-indices-with-depth" class="nav-link" data-scroll-target="#evolution-of-trophic-diversity-indices-with-depth">Evolution of trophic diversity indices with depth</a></li>
  </ul></li>
  <li><a href="#isotopic-niches-segregation-vs-overlap" id="toc-isotopic-niches-segregation-vs-overlap" class="nav-link" data-scroll-target="#isotopic-niches-segregation-vs-overlap">3. Isotopic niches: segregation vs overlap</a>
  <ul class="collapse">
  <li><a href="#community-level" id="toc-community-level" class="nav-link" data-scroll-target="#community-level">Community level</a>
  <ul class="collapse">
  <li><a href="#overlap-between-species-with-ellipses-at-40" id="toc-overlap-between-species-with-ellipses-at-40" class="nav-link" data-scroll-target="#overlap-between-species-with-ellipses-at-40">Overlap between species with ellipses at 40%</a></li>
  </ul></li>
  <li><a href="#by-depth-layer" id="toc-by-depth-layer" class="nav-link" data-scroll-target="#by-depth-layer">By depth layer</a>
  <ul class="collapse">
  <li><a href="#epipelagic-1" id="toc-epipelagic-1" class="nav-link" data-scroll-target="#epipelagic-1">Epipelagic</a></li>
  <li><a href="#upper-mesopelagic-1" id="toc-upper-mesopelagic-1" class="nav-link" data-scroll-target="#upper-mesopelagic-1">Upper-mesopelagic</a></li>
  <li><a href="#lower-mesopelagic-1" id="toc-lower-mesopelagic-1" class="nav-link" data-scroll-target="#lower-mesopelagic-1">Lower-mesopelagic</a></li>
  <li><a href="#bathypelagic-1" id="toc-bathypelagic-1" class="nav-link" data-scroll-target="#bathypelagic-1">Bathypelagic</a></li>
  </ul></li>
  <li><a href="#by-station" id="toc-by-station" class="nav-link" data-scroll-target="#by-station">By station</a>
  <ul class="collapse">
  <li><a href="#station-z0492---370m" id="toc-station-z0492---370m" class="nav-link" data-scroll-target="#station-z0492---370m">Station Z0492 - 370m</a></li>
  <li><a href="#station-z0512---555m" id="toc-station-z0512---555m" class="nav-link" data-scroll-target="#station-z0512---555m">Station Z0512 - 555m</a></li>
  <li><a href="#station-z0503---715m" id="toc-station-z0503---715m" class="nav-link" data-scroll-target="#station-z0503---715m">Station Z0503 - 715m</a></li>
  <li><a href="#station-z0518---1000m" id="toc-station-z0518---1000m" class="nav-link" data-scroll-target="#station-z0518---1000m">Station Z0518 - 1000m</a></li>
  <li><a href="#station-z0524---1010m" id="toc-station-z0524---1010m" class="nav-link" data-scroll-target="#station-z0524---1010m">Station Z0524 - 1010m</a></li>
  <li><a href="#station-z0497---1335m" id="toc-station-z0497---1335m" class="nav-link" data-scroll-target="#station-z0497---1335m">Station Z0497 - 1335m</a></li>
  </ul></li>
  <li><a href="#cluster" id="toc-cluster" class="nav-link" data-scroll-target="#cluster">cluster</a></li>
  <li><a href="#distribution" id="toc-distribution" class="nav-link" data-scroll-target="#distribution">Distribution</a></li>
  <li><a href="#intraspecific-changes-over-the-depth-range-evolution-of-niche-area-kud-with-depth" id="toc-intraspecific-changes-over-the-depth-range-evolution-of-niche-area-kud-with-depth" class="nav-link" data-scroll-target="#intraspecific-changes-over-the-depth-range-evolution-of-niche-area-kud-with-depth">Intraspecific changes over the depth range ? Evolution of niche area (KUD) with depth</a>
  <ul class="collapse">
  <li><a href="#lampanyctus-crocodilus" id="toc-lampanyctus-crocodilus" class="nav-link" data-scroll-target="#lampanyctus-crocodilus">Lampanyctus crocodilus</a></li>
  <li><a href="#xenodermichthys-copei" id="toc-xenodermichthys-copei" class="nav-link" data-scroll-target="#xenodermichthys-copei">Xenodermichthys copei</a></li>
  <li><a href="#argyropelecus-olfersii" id="toc-argyropelecus-olfersii" class="nav-link" data-scroll-target="#argyropelecus-olfersii">Argyropelecus olfersii</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Trophic ecology</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>How does the trophic structure and competitive interactions within the meso-bathypelagic fish community of the Bay of Biscay evolve along the water column? </strong></p>
<p><strong>1- Isotopic diversity indices</strong></p>
<ul>
<li><p>How isotopic richness evolves with depth?</p></li>
<li><p>The species with the highest biomass have contrasting isotopic values to limit competition?</p></li>
</ul>
<p><strong>2- Focus on segregation/overlap of niches</strong></p>
<ul>
<li><p>At the community level, is there significant overlap of isotopic niches between species?</p></li>
<li><p>Is this overlap reduced when species are separated according to their sampling depth?</p></li>
<li><p>Is there more or less overlap between species belonging to the same family?</p></li>
<li><p>At the intraspecific level, does the position of the isotopic niche of a species change according to its sampling depth?</p></li>
</ul>
<section id="representativeness-of-the-sampling-baseline-variation-krill" class="level1">
<h1>1. Representativeness of the sampling + baseline variation (krill)</h1>
<section id="krill-data" class="level2">
<h2 class="anchored" data-anchor-id="krill-data">Krill data</h2>
<ul>
<li>Significant variability of krill isotope signatures with depth?</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>isotope_data <span class="ot">&lt;-</span>  utils<span class="sc">::</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"raw-data"</span>, <span class="st">"isotopic_data_2021.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> T,<span class="at">dec =</span> <span class="st">","</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>isotope_data_krill <span class="ot">&lt;-</span> isotope_data <span class="sc">%&gt;%</span> <span class="fu">filter</span> (species <span class="sc">==</span> <span class="st">"Meganyctiphanes_norvegica"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>first_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> isotope_data_krill, <span class="fu">aes</span>(<span class="at">x =</span> d13c, <span class="at">y =</span> d15n)) <span class="sc">+</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span> <span class="fu">factor</span>(trawling_depth)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(delta<span class="sc">^</span>{<span class="dv">15</span>}, <span class="st">"N (\u2030)"</span>))) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(delta<span class="sc">^</span>{<span class="dv">13</span>}, <span class="st">"C (\u2030)"</span>))) <span class="sc">+</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_color_paletteer_d</span>(<span class="st">"rcartocolor::Teal"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise By depth </span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>data_krill_sum <span class="ot">&lt;-</span> isotope_data_krill <span class="sc">%&gt;%</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trawling_depth) <span class="sc">%&gt;%</span> </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">mC =</span> <span class="fu">mean</span>(d13c), </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">sdC =</span> <span class="fu">sd</span>(d13c), </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">mN =</span> <span class="fu">mean</span>(d15n), </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">sdN =</span> <span class="fu">sd</span>(d15n))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>second_plot <span class="ot">&lt;-</span> first_plot <span class="sc">+</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> data_krill_sum,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mC, <span class="at">y =</span> mN, <span class="at">ymin =</span> mN <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>sdN, <span class="at">ymax =</span> mN <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>sdN, <span class="at">col =</span> <span class="fu">factor</span>(trawling_depth)), </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> data_krill_sum, </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                 <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mC, <span class="at">y =</span> mN,<span class="at">xmin =</span> mC <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>sdC, <span class="at">xmax =</span> mC <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>sdC, <span class="at">col =</span> <span class="fu">factor</span>(trawling_depth)),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="dv">0</span>, <span class="at">size=</span><span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_krill_sum, </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> mC, <span class="at">y =</span> mN, <span class="at">fill =</span> <span class="fu">factor</span>(trawling_depth),<span class="at">col =</span> <span class="fu">factor</span>(trawling_depth), <span class="at">shape =</span> <span class="fu">factor</span>(trawling_depth)),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">8</span>, <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_fill_paletteer_d</span>(<span class="st">"rcartocolor::Teal"</span>)<span class="sc">+</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_color_paletteer_d</span>(<span class="st">"rcartocolor::Teal"</span>)<span class="sc">+</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">shape=</span><span class="st">"Trawling depth (m)"</span>, <span class="at">col=</span><span class="st">"Trawling depth (m)"</span>, <span class="at">fill=</span> <span class="st">"Trawling depth (m)"</span> )</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(second_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="trophic_ecology_files/figure-html/krill_data-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sampling" class="level2">
<h2 class="anchored" data-anchor-id="sampling">Sampling</h2>
<p>Percentage of the diversity sampled by depth layer :</p>
<ul>
<li>Epipelagic : 45%</li>
<li>Upper-mesopelagic: 33%</li>
<li>Lower-mesopelagic : 28%</li>
<li>Bathypelagic : 15%</li>
</ul>
<p>Percentage of the biomass sampled by depth layer :</p>
<ul>
<li>Epipelagic : 96%</li>
<li>Upper-mesopelagic: 90%</li>
<li>Lower-mesopelagic : 54% ( <em>A.carbo</em> 18%)</li>
<li>Bathypelagic : 60% ( <em>A.carbo</em> 10%)</li>
</ul>
</section>
</section>
<section id="isotopic-diversity-index" class="level1">
<h1>2. Isotopic diversity index</h1>
<section id="formatting-of-data-and-calculation-of-relative-biomasses-within-each-depth-layer" class="level2">
<h2 class="anchored" data-anchor-id="formatting-of-data-and-calculation-of-relative-biomasses-within-each-depth-layer">Formatting of data and calculation of relative biomasses within each depth layer</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>isotope_data_fish <span class="ot">&lt;-</span> isotope_data <span class="sc">%&gt;%</span> <span class="fu">filter</span> (species <span class="sc">!=</span> <span class="st">"Meganyctiphanes_norvegica"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sourcing the R functions from 'si_div' R script</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/si_div.R"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Format indiviudal_si</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>individuals_si <span class="ot">&lt;-</span> isotope_data_fish <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(individual_code, station, d13c, d15n, species_code) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">indiv_ID=</span>individual_code,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">d13C=</span> d13c,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">d15N =</span>d15n,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">Species_code=</span> species_code)<span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">depth_layer =</span> <span class="fu">case_when</span>(station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Z0508"</span>) <span class="sc">~</span><span class="st">"epipelagic"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                                 station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Z0492"</span>, <span class="st">"Z0512"</span>) <span class="sc">~</span><span class="st">"upper_mesopelagic"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                                 station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Z0503"</span>, <span class="st">"Z0518"</span>) <span class="sc">~</span><span class="st">"lower_mesopelagic"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                 station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Z0524"</span>,<span class="st">"Z0497"</span>) <span class="sc">~</span><span class="st">"bathypelagic"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>station)<span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Species_code)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Format species_status_biomass with complete data of evhoe 2021</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># use of all EVHOE 2021 catch data to calculate relative biomasses (not just individuals sampled for isotope)</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>catch_data_evhoe21 <span class="ot">&lt;-</span>  utils<span class="sc">::</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"raw-data"</span>, <span class="st">"data_catch_2021_mesopelagic_sp_sampled.csv"</span>), <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header =</span> T,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">dec =</span> <span class="st">"."</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>species_status_biomass <span class="ot">&lt;-</span> catch_data_evhoe21<span class="sc">%&gt;%</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">depth_layer =</span> <span class="fu">case_when</span>(Code_Station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Z0508"</span>) <span class="sc">~</span><span class="st">"epipelagic"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                                 Code_Station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Z0492"</span>, <span class="st">"Z0512"</span>) <span class="sc">~</span><span class="st">"upper_mesopelagic"</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                                 Code_Station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Z0503"</span>, <span class="st">"Z0518"</span>) <span class="sc">~</span><span class="st">"lower_mesopelagic"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                                 Code_Station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Z0524"</span>,<span class="st">"Z0497"</span>) <span class="sc">~</span><span class="st">"bathypelagic"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Code_Station, Tot_V_HV, Nom_Scientifique, depth_layer, Species_code, family)<span class="sc">%&gt;%</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()<span class="sc">%&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Nom_Scientifique, depth_layer)<span class="sc">%&gt;%</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biomass_sp=</span><span class="fu">sum</span>(Tot_V_HV))<span class="sc">%&gt;%</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Code_Station, Tot_V_HV))<span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()<span class="sc">%&gt;%</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(depth_layer)<span class="sc">%&gt;%</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biomass_tot=</span><span class="fu">sum</span>(biomass_sp))<span class="sc">%&gt;%</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_Biomass=</span>biomass_sp<span class="sc">/</span>biomass_tot<span class="sc">*</span><span class="dv">100</span>)<span class="sc">%&gt;%</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(biomass_sp,  biomass_tot))<span class="sc">%&gt;%</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Species_name=</span> Nom_Scientifique,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">Status=</span>depth_layer,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">Order=</span>family)<span class="sc">%&gt;%</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Status, <span class="at">.after=</span>Order)<span class="sc">%&gt;%</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(rel_Biomass, <span class="at">.after=</span>Species_code)<span class="sc">%&gt;%</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Species_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="definitions" class="level2">
<h2 class="anchored" data-anchor-id="definitions">Definitions:</h2>
<ul>
<li><p><strong>Isotopic richness</strong> : increases when the space occupied by the species (convex hull) is large</p></li>
<li><p><strong>Isotopic divergence</strong> : tends to 1 when all points (or their weights) are located at the edge of the convex hull, i.e.&nbsp;when the oragnisms with the most extreme isotopic values dominate the food web</p></li>
<li><p><strong>Isotopic dispersion</strong>: equal to 1 when most points (or their weights) are far from the center of gravity of the point group, i.e.&nbsp;when organisms tend to have contrasting isotopic values</p></li>
<li><p><strong>Isotopic evenness</strong>: tends to 1 when all organisms are equally distributed in isotopic space</p></li>
<li><p><strong>Isotopic uniqueness</strong>: tends to 1 when most organisms (or their weights) are isolated in isotopic space, i.e.&nbsp;when most organisms (or those with the highest abundance) are isolated in isotopic space, their isotopic values are very different from the rest of the organisms</p></li>
</ul>
</section>
<section id="calculation-of-indices-within-each-depth-layer" class="level2">
<h2 class="anchored" data-anchor-id="calculation-of-indices-within-each-depth-layer">Calculation of indices within each depth layer</h2>
<ul>
<li><p>How to divide the depth layers? One station at 1000m and another at 1010, one of which is near the bottom: to be treated separately?</p></li>
<li><p>If percentage of sampled diversity low, use of isotopic diversity indices relevant? % biomass sampled within each depth layer is high (especially if <em>A. carbo</em> is excluded, and each most important species in terms of biomass have been sampled in each depth layer) and the indices are correlated to the biomass, so they remain relevant?</p></li>
<li><p>only the richness is not related to the biomass: to keep?</p></li>
</ul>
<section id="epipelagic" class="level3">
<h3 class="anchored" data-anchor-id="epipelagic">Epipelagic</h3>
<ul>
<li><p>station at 25m, 5 species sampled</p></li>
<li><p>Low isotopic richness, the species with the highest biomasses have contrasted isotopic values and these species dominate the food web at this depth in terms of biomass ( <em>N. bolini</em> and M. <em>muelleri</em>)</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Epipelagic layer ----</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>individuals_si_epipelagic <span class="ot">&lt;-</span> individuals_si<span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(depth_layer<span class="sc">==</span><span class="st">"epipelagic"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>depth_layer)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>status_biomass_epipelagic <span class="ot">&lt;-</span> species_status_biomass<span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Status<span class="sc">==</span><span class="st">"epipelagic"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># computing mean Stable Isotope values for each species</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># "group" column identical to species_code to fit with input format of function meanSI_group</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># no "weight" input as number of indivuals sampled per species did not mirror actual species biomass</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>individuals_si_ep<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">group=</span>individuals_si_epipelagic[,<span class="st">"Species_code"</span>], individuals_si_epipelagic)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>mean_si_species_ep<span class="ot">&lt;-</span><span class="fu">meanSI_group</span>(individuals_si_ep)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># computing coefficent of variation within each species to assess intraspecific variability</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">CV_d13C=</span>mean_si_species_ep[,<span class="st">"sd_d13C"</span>]<span class="sc">/</span>mean_si_species_ep[,<span class="st">"d13C"</span>], <span class="at">CV_d15N=</span>mean_si_species_ep[,<span class="st">"sd_d15N"</span>]<span class="sc">/</span>mean_si_species_ep[,<span class="st">"d15N"</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                CV_d13C    CV_d15N
Lesti-sphy -0.009163991 0.03266115
Mau-mue    -0.005224151 0.05249590
Myct-pun   -0.009814716 0.04041982
Noto-bol   -0.009178283 0.02755544
Noto-kro   -0.012155251 0.02166277</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; intraspecific variability is overall low (&lt;20%)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># checking that species codes are the same in the two tables</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#row.names(mean_si_species)==status_biomass_epipelagic[,"Species_code"] # OK</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># building a single dataframe with all data for computing isotopic diversity indices</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>data_fish_ep<span class="ot">&lt;-</span><span class="fu">data.frame</span>(mean_si_species_ep[,<span class="fu">c</span>(<span class="st">"d13C"</span>,<span class="st">"d15N"</span>, <span class="st">"sd_d13C"</span>,<span class="st">"sd_d15N"</span>)], <span class="at">rel_Biomass=</span>status_biomass_epipelagic[,<span class="st">"rel_Biomass"</span>], <span class="at">Status=</span>status_biomass_epipelagic[,<span class="st">"Status"</span>], <span class="at">latin_name=</span>status_biomass_epipelagic[,<span class="st">"Species_name"</span>])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling mean stable isotopes values using function "scale_rge01"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>data_fish_scl_ep<span class="ot">&lt;-</span><span class="fu">scaleSI_range01</span>(data_fish_ep)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># computing isotopic diversity of the whole fish assemblage using scaled isotopic values and species relative biomass</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>ID_scl_ab_ep<span class="ot">&lt;-</span><span class="fu">IDiversity</span>(<span class="at">cons=</span>data_fish_scl_ep, <span class="at">weight=</span>data_fish_scl_ep[,<span class="fu">c</span>(<span class="st">"rel_Biomass"</span>)], <span class="at">nm_plot=</span><span class="st">"epipelagic"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># printing results</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(ID_scl_ab_ep,<span class="dv">3</span>)) </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">round(ID_scl_ab_ep, 3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min_d13C</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_d15N</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_d13C</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_d15N</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">range_d13C</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">range_d15N</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IPos_d13C</td>
<td style="text-align: right;">0.541</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPos_d15N</td>
<td style="text-align: right;">0.512</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IRic</td>
<td style="text-align: right;">0.306</td>
</tr>
<tr class="even">
<td style="text-align: left;">IDiv</td>
<td style="text-align: right;">0.953</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IDis</td>
<td style="text-align: right;">0.898</td>
</tr>
<tr class="even">
<td style="text-align: left;">IEve</td>
<td style="text-align: right;">0.446</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUni</td>
<td style="text-align: right;">0.564</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="epipelagic_d13C_d15N.jpeg" class="img-fluid figure-img" width="550"></p>
<p></p><figcaption class="figure-caption">epipelagic</figcaption><p></p>
</figure>
</div>
</section>
<section id="upper-mesopelagic" class="level3">
<h3 class="anchored" data-anchor-id="upper-mesopelagic">Upper-mesopelagic</h3>
<ul>
<li><p>2 stations : 370 &amp; 555m, 6 species sampled</p></li>
<li><p>Low isotopic richness but species with the highest biomass ( <em>N.kroyeri</em> &amp; <em>X. copei</em>) are located at the edge of the convex hull, with contrasting isotopic values. The species are rather evenly distributed and isolated in the isotopic space.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upper_mesopelagic layer ----</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>individuals_si_upper_meso <span class="ot">&lt;-</span> individuals_si<span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(depth_layer<span class="sc">==</span><span class="st">"upper_mesopelagic"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>depth_layer)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>status_biomass_upper_meso <span class="ot">&lt;-</span> species_status_biomass<span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Status<span class="sc">==</span><span class="st">"upper_mesopelagic"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># computing mean Stable Isotope values for each species</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># "group" column identical to species_code to fit with input format of function meanSI_group</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># no "weight" input as number of indivuals sampled per species did not mirror actual species biomass</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>individuals_si_um<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">group=</span>individuals_si_upper_meso[,<span class="st">"Species_code"</span>], individuals_si_upper_meso)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>mean_si_species_um<span class="ot">&lt;-</span><span class="fu">meanSI_group</span>(individuals_si_um)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># computing coefficent of variation within each species to assess intraspecific variability</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">CV_d13C=</span>mean_si_species_um[,<span class="st">"sd_d13C"</span>]<span class="sc">/</span>mean_si_species_um[,<span class="st">"d13C"</span>], <span class="at">CV_d15N=</span>mean_si_species_um[,<span class="st">"sd_d15N"</span>]<span class="sc">/</span>mean_si_species_um[,<span class="st">"d15N"</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              CV_d13C    CV_d15N
Arct-ris -0.010421638 0.03438256
Arg-olf  -0.008552011 0.04283576
Lamp-cro -0.015534945 0.07982239
Myct-pun -0.019927081 0.04074265
Noto-kro -0.013115883 0.02240457
Xeno-cop -0.012364479 0.07722547</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; intraspecific variability is overall low (&lt;20%)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># checking that species codes are the same in the two tables</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#row.names(mean_si_species_um)==status_biomass_upper_meso[,"Species_code"] # OK</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># building a single dataframe with all data for computing isotopic diversity indices</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>data_fish_um <span class="ot">&lt;-</span><span class="fu">data.frame</span>(mean_si_species_um[,<span class="fu">c</span>(<span class="st">"d13C"</span>,<span class="st">"d15N"</span>, <span class="st">"sd_d13C"</span>,<span class="st">"sd_d15N"</span>)], <span class="at">rel_Biomass=</span>status_biomass_upper_meso[,<span class="st">"rel_Biomass"</span>], <span class="at">Status=</span>status_biomass_upper_meso[,<span class="st">"Status"</span>], <span class="at">latin_name=</span>status_biomass_upper_meso[,<span class="st">"Species_name"</span>])</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling mean stable isotopes values using function "scale_rge01"</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>data_fish_scl_um<span class="ot">&lt;-</span><span class="fu">scaleSI_range01</span>(data_fish_um)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># computing isotopic diversity of the whole fish assemblage using scaled isotopic values and species relative biomass</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ID_scl_ab_um<span class="ot">&lt;-</span><span class="fu">IDiversity</span>(<span class="at">cons=</span>data_fish_scl_um, <span class="at">weight=</span>data_fish_scl_um[,<span class="fu">c</span>(<span class="st">"rel_Biomass"</span>)], <span class="at">nm_plot=</span><span class="st">"upper_mesopelagic"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># printing results</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(ID_scl_ab_um,<span class="dv">3</span>)) </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">round(ID_scl_ab_um, 3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min_d13C</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_d15N</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_d13C</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_d15N</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">range_d13C</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">range_d15N</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IPos_d13C</td>
<td style="text-align: right;">0.519</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPos_d15N</td>
<td style="text-align: right;">0.476</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IRic</td>
<td style="text-align: right;">0.287</td>
</tr>
<tr class="even">
<td style="text-align: left;">IDiv</td>
<td style="text-align: right;">0.867</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IDis</td>
<td style="text-align: right;">0.827</td>
</tr>
<tr class="even">
<td style="text-align: left;">IEve</td>
<td style="text-align: right;">0.755</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUni</td>
<td style="text-align: right;">0.797</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="upper_mesopelagic_d13C_d15N.jpeg" class="img-fluid figure-img" width="550"></p>
<p></p><figcaption class="figure-caption">upper_mesopelagic</figcaption><p></p>
</figure>
</div>
</section>
<section id="lower-mesopelagic" class="level3">
<h3 class="anchored" data-anchor-id="lower-mesopelagic">Lower-mesopelagic</h3>
<ul>
<li><p>2 stations : 715 &amp; 1000m, 9 species sampled</p></li>
<li><p>Isotopic richness slightly higher. In contrast, all other indices are rather low: the species with the largest biomasses (especially <em>L.crocodilus</em>) are located in the center of the isotopic space and do not have very contracted isotopic values. The species are not evenly distributed in the isotopic space.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lower mesopelagic layer ----</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>individuals_si_lower_meso <span class="ot">&lt;-</span> individuals_si<span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(depth_layer<span class="sc">==</span><span class="st">"lower_mesopelagic"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>depth_layer)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>status_biomass_lower_meso <span class="ot">&lt;-</span> species_status_biomass<span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Status<span class="sc">==</span><span class="st">"lower_mesopelagic"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># computing mean Stable Isotope values for each species</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># "group" column identical to species_code to fit with input format of function meanSI_group</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># no "weight" input as number of indivuals sampled per species did not mirror actual species biomass</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>individuals_si_lm<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">group=</span>individuals_si_lower_meso[,<span class="st">"Species_code"</span>], individuals_si_lower_meso)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>mean_si_species_lm<span class="ot">&lt;-</span><span class="fu">meanSI_group</span>(individuals_si_lm)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># computing coefficent of variation within each species to assess intraspecific variability</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">CV_d13C=</span>mean_si_species_lm[,<span class="st">"sd_d13C"</span>]<span class="sc">/</span>mean_si_species_lm[,<span class="st">"d13C"</span>], <span class="at">CV_d15N=</span>mean_si_species_lm[,<span class="st">"sd_d15N"</span>]<span class="sc">/</span>mean_si_species_lm[,<span class="st">"d15N"</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              CV_d13C    CV_d15N
Arct-ris -0.013383792 0.02784671
Arg-olf  -0.009812119 0.03092443
Ben-gla  -0.015512985 0.06444602
Cyclo    -0.009264821 0.04946692
Lamp-cro -0.020344506 0.04819340
Mau-arg  -0.009632001 0.03191368
Ser-bea  -0.012549696 0.06183851
Ser-koef -0.022852986 0.05388211
Xeno-cop -0.012017717 0.06196185</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; intraspecific variability is overall low (&lt;20%)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># checking that species codes are the same in the two tables</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#row.names(mean_si_species_lm)==status_biomass_lower_meso[,"Species_code"] # OK</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># building a single dataframe with all data for computing isotopic diversity indices</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>data_fish_lm <span class="ot">&lt;-</span><span class="fu">data.frame</span>(mean_si_species_lm[,<span class="fu">c</span>(<span class="st">"d13C"</span>,<span class="st">"d15N"</span>, <span class="st">"sd_d13C"</span>,<span class="st">"sd_d15N"</span>)], <span class="at">rel_Biomass=</span>status_biomass_lower_meso[,<span class="st">"rel_Biomass"</span>], <span class="at">Status=</span>status_biomass_lower_meso[,<span class="st">"Status"</span>], <span class="at">latin_name=</span>status_biomass_lower_meso[,<span class="st">"Species_name"</span>])</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling mean stable isotopes values using function "scale_rge01"</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>data_fish_scl_lm<span class="ot">&lt;-</span><span class="fu">scaleSI_range01</span>(data_fish_lm)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># computing isotopic diversity of the whole fish assemblage using scaled isotopic values and species relative biomass</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ID_scl_ab_lm<span class="ot">&lt;-</span><span class="fu">IDiversity</span>(<span class="at">cons=</span>data_fish_scl_lm, <span class="at">weight=</span>data_fish_scl_lm[,<span class="fu">c</span>(<span class="st">"rel_Biomass"</span>)], <span class="at">nm_plot=</span><span class="st">"lower_mesopelagic"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># printing results</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(ID_scl_ab_lm,<span class="dv">3</span>)) </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">round(ID_scl_ab_lm, 3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min_d13C</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_d15N</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_d13C</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_d15N</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">range_d13C</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">range_d15N</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IPos_d13C</td>
<td style="text-align: right;">0.627</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPos_d15N</td>
<td style="text-align: right;">0.415</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IRic</td>
<td style="text-align: right;">0.477</td>
</tr>
<tr class="even">
<td style="text-align: left;">IDiv</td>
<td style="text-align: right;">0.561</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IDis</td>
<td style="text-align: right;">0.447</td>
</tr>
<tr class="even">
<td style="text-align: left;">IEve</td>
<td style="text-align: right;">0.535</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUni</td>
<td style="text-align: right;">0.448</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lower_mesopelagic_d13C_d15N.jpeg" class="img-fluid figure-img" width="550"></p>
<p></p><figcaption class="figure-caption">lower_mesopelagic</figcaption><p></p>
</figure>
</div>
</section>
<section id="bathypelagic" class="level3">
<h3 class="anchored" data-anchor-id="bathypelagic">Bathypelagic</h3>
<ul>
<li><p>2 stations : 1010 (close to the bottom) &amp; 1335m, 7 species sampled</p></li>
<li><p>The species with the highest biomass, <em>L.crocodilus</em>, shows extreme isotopic values compared to the rest of the community (high divergence index and uniqueness)</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lower mesopelagic layer ----</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>individuals_si_bathypelagic <span class="ot">&lt;-</span> individuals_si<span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(depth_layer<span class="sc">==</span><span class="st">"bathypelagic"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>depth_layer)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>status_biomass_bathypelagic <span class="ot">&lt;-</span> species_status_biomass<span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Status<span class="sc">==</span><span class="st">"bathypelagic"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># computing mean Stable Isotope values for each species</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># "group" column identical to species_code to fit with input format of function meanSI_group</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># no "weight" input as number of indivuals sampled per species did not mirror actual species biomass</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>individuals_si_b<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">group=</span>individuals_si_bathypelagic[,<span class="st">"Species_code"</span>], individuals_si_bathypelagic)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>mean_si_species_b<span class="ot">&lt;-</span><span class="fu">meanSI_group</span>(individuals_si_b)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># computing coefficent of variation within each species to assess intraspecific variability</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">CV_d13C=</span>mean_si_species_b[,<span class="st">"sd_d13C"</span>]<span class="sc">/</span>mean_si_species_b[,<span class="st">"d13C"</span>], <span class="at">CV_d15N=</span>mean_si_species_b[,<span class="st">"sd_d15N"</span>]<span class="sc">/</span>mean_si_species_b[,<span class="st">"d15N"</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               CV_d13C    CV_d15N
Arg-olf   -0.011354958 0.04217724
Lamp-cro  -0.017123430 0.05265353
Lamp-mac  -0.022058396 0.02734756
Mel-atlan -0.009854421 0.04078758
Myct-pun  -0.024242014 0.04136229
Ser-bea   -0.013913445 0.05673029
Xeno-cop  -0.010997820 0.05399656</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; intraspecific variability is overall low (&lt;20%)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># checking that species codes are the same in the two tables</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#row.names(mean_si_species_b)==status_biomass_bathypelagic[,"Species_code"] # OK</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># building a single dataframe with all data for computing isotopic diversity indices</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>data_fish_b <span class="ot">&lt;-</span><span class="fu">data.frame</span>(mean_si_species_b[,<span class="fu">c</span>(<span class="st">"d13C"</span>,<span class="st">"d15N"</span>, <span class="st">"sd_d13C"</span>,<span class="st">"sd_d15N"</span>)], <span class="at">rel_Biomass=</span>status_biomass_bathypelagic[,<span class="st">"rel_Biomass"</span>], <span class="at">Status=</span>status_biomass_bathypelagic[,<span class="st">"Status"</span>], <span class="at">latin_name=</span>status_biomass_bathypelagic[,<span class="st">"Species_name"</span>])</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling mean stable isotopes values using function "scale_rge01"</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>data_fish_scl_b<span class="ot">&lt;-</span><span class="fu">scaleSI_range01</span>(data_fish_b)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># computing isotopic diversity of the whole fish assemblage using scaled isotopic values and species relative biomass</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>ID_scl_ab_b<span class="ot">&lt;-</span><span class="fu">IDiversity</span>(<span class="at">cons=</span>data_fish_scl_b, <span class="at">weight=</span>data_fish_scl_b[,<span class="fu">c</span>(<span class="st">"rel_Biomass"</span>)], <span class="at">nm_plot=</span><span class="st">"bathypelagic"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># printing results</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>(ID_scl_ab_lm,<span class="dv">3</span>)) </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">round(ID_scl_ab_lm, 3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min_d13C</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">min_d15N</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_d13C</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_d15N</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">range_d13C</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">range_d15N</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IPos_d13C</td>
<td style="text-align: right;">0.627</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPos_d15N</td>
<td style="text-align: right;">0.415</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IRic</td>
<td style="text-align: right;">0.477</td>
</tr>
<tr class="even">
<td style="text-align: left;">IDiv</td>
<td style="text-align: right;">0.561</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IDis</td>
<td style="text-align: right;">0.447</td>
</tr>
<tr class="even">
<td style="text-align: left;">IEve</td>
<td style="text-align: right;">0.535</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUni</td>
<td style="text-align: right;">0.448</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="bathypelagic_d13C_d15N.jpeg" class="img-fluid figure-img" width="550"></p>
<p></p><figcaption class="figure-caption">bathypelagic</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="evolution-of-trophic-diversity-indices-with-depth" class="level2">
<h2 class="anchored" data-anchor-id="evolution-of-trophic-diversity-indices-with-depth">Evolution of trophic diversity indices with depth</h2>
<ul>
<li><p>The lower mesopelagic layer stands out with low indices for all measurements (except richness). Within this layer the species with the highest biomass (especially <em>L.crocodilus</em>) are located near the centre of the convex hull with relatively similar isotopic values (no species with rare isotopic values). It is also the depth layer with the highest number of species sampled.</p></li>
<li><p>Within the other stations the divergence is high, i.e.&nbsp;the species that dominate the food web in terms of biomass have extreme isotopic values.</p></li>
<li><p>The upper mesopelagic layer also stands out with high values for all indices. It has the highest uniqueness and evenness values, which means that the species with the largest biomass are isolated in the isotopic space but also that the species are equally distributed. Indeed, the two species with the highest biomass ( <em>X.copei, N.kroyeri</em>) are located on opposite sides of the isotopic space.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load library</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>depth <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"epipelagic"</span>, <span class="st">"upper_mesopelagic"</span>, <span class="st">"lower_mesopelagic"</span>, <span class="st">"bathypelagic"</span> )</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>richness <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.306</span>, <span class="fl">0.287</span>, <span class="fl">0.477</span>, <span class="fl">0.441</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>divergence <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.953</span>, <span class="fl">0.867</span>, <span class="fl">0.561</span>, <span class="fl">0.971</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>disperion <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.898</span>, <span class="fl">0.827</span>, <span class="fl">0.447</span>, <span class="fl">0.516</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>evenness <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.446</span>, <span class="fl">0.755</span>, <span class="fl">0.535</span>, <span class="fl">0.442</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>uniqueness <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.564</span>, <span class="fl">0.797</span>, <span class="fl">0.448</span>, <span class="fl">0.765</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>isotopic_indices <span class="ot">&lt;-</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(depth, richness, divergence, disperion, evenness, uniqueness) <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(richness, divergence, disperion, evenness, uniqueness),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"indices"</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>isotopic_indices<span class="sc">$</span>depth <span class="ot">&lt;-</span> <span class="fu">factor</span>(isotopic_indices<span class="sc">$</span>depth, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"epipelagic"</span>, <span class="st">"upper_mesopelagic"</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="st">"lower_mesopelagic"</span>, <span class="st">"bathypelagic"</span>))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(isotopic_indices, <span class="fu">aes</span>(<span class="at">x=</span>depth, <span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>depth), <span class="at">size=</span><span class="fl">2.3</span>)<span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>indices)<span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#93c3ff"</span>,<span class="st">"#74a8ff"</span>,<span class="st">"#538def"</span>,<span class="st">"#2c73d2"</span>))<span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span> </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="trophic_ecology_files/figure-html/trophic_indices_df-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="isotopic-niches-segregation-vs-overlap" class="level1">
<h1>3. Isotopic niches: segregation vs overlap</h1>
<div class="cell">

</div>
<section id="community-level" class="level2">
<h2 class="anchored" data-anchor-id="community-level">Community level</h2>
<ul>
<li>ellipses at 40%</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>nichecol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E4A33A"</span>,<span class="st">"#F67451"</span>,<span class="st">"#D664BE"</span>, <span class="st">"#3DA5D9"</span>, <span class="st">"#94b3ae"</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#18206F"</span>,<span class="st">"#FD151B"</span>,<span class="st">"#049A8F"</span>,<span class="st">"#072AC8"</span>, <span class="st">"purple"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"#d193f7"</span>,<span class="st">"#d8c2ab"</span>,<span class="st">"#678FCB"</span>,<span class="st">"#A63A49"</span>,<span class="st">"#00547A"</span>, <span class="st">"#6B54A0"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>community_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> isotope_data_fish, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> d13c, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> d15n)) <span class="sc">+</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> species, <span class="at">shape=</span> family), <span class="at">size =</span> <span class="fl">2.3</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>nichecol)<span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>nichecol)<span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span><span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">8</span>, <span class="dv">19</span>, <span class="dv">18</span>, <span class="dv">3</span>, <span class="dv">13</span>, <span class="dv">6</span>) )<span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">13</span><span class="sc">*</span>C<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">21</span>, <span class="sc">-</span><span class="fl">18.5</span>)) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">15</span><span class="sc">*</span>N<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Ellipses</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># How big the ellipse </span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>p.ell <span class="ot">&lt;-</span> <span class="fl">0.40</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>ellipse_community <span class="ot">&lt;-</span> community_plot <span class="sc">+</span> </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> species, </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> species, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> species), </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.2</span>, </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> p.ell,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"norm"</span>,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"polygon"</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ellipse_community)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="trophic_ecology_files/figure-html/community_ellipses-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<section id="overlap-between-species-with-ellipses-at-40" class="level3">
<h3 class="anchored" data-anchor-id="overlap-between-species-with-ellipses-at-40">Overlap between species with ellipses at 40%</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OVERLAP between species, all depth ----</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>test.elp_community <span class="ot">&lt;-</span> rKIN<span class="sc">::</span><span class="fu">estEllipse</span>(<span class="at">data=</span> isotope_data_fish,  <span class="at">x=</span><span class="st">"d13c"</span>, <span class="at">y=</span><span class="st">"d15n"</span>, <span class="at">group=</span><span class="st">"species"</span>, <span class="at">levels=</span><span class="dv">40</span>, <span class="at">smallSamp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the area of each polygon</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>elp.area_community <span class="ot">&lt;-</span> rKIN<span class="sc">::</span><span class="fu">getArea</span>(test.elp_community)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># determine polygon overlap for all polygons</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>elp.olp_community <span class="ot">&lt;-</span> rKIN<span class="sc">::</span><span class="fu">calcOverlap</span>(test.elp_community)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>elp.olp_community_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(elp.olp_community, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(elp.olp_community_melt, <span class="fu">aes</span>(<span class="at">x=</span>OverlapID, <span class="at">y=</span>variable, <span class="at">fill=</span>value)) <span class="sc">+</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">alpha=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">high =</span> <span class="st">"darkblue"</span>, <span class="at">low=</span><span class="st">"grey99"</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> value), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>,<span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>), </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="trophic_ecology_files/figure-html/community_overlaps-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
</section>
<section id="by-depth-layer" class="level2">
<h2 class="anchored" data-anchor-id="by-depth-layer">By depth layer</h2>
<section id="epipelagic-1" class="level3">
<h3 class="anchored" data-anchor-id="epipelagic-1">Epipelagic</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_epipelagic-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_epipelagic-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="upper-mesopelagic-1" class="level3">
<h3 class="anchored" data-anchor-id="upper-mesopelagic-1">Upper-mesopelagic</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_upper_meso-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_upper_meso-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lower-mesopelagic-1" class="level3">
<h3 class="anchored" data-anchor-id="lower-mesopelagic-1">Lower-mesopelagic</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_lower_meso-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_lower_meso-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bathypelagic-1" class="level3">
<h3 class="anchored" data-anchor-id="bathypelagic-1">Bathypelagic</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_bathypelagic-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_bathypelagic-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="by-station" class="level2">
<h2 class="anchored" data-anchor-id="by-station">By station</h2>
<section id="station-z0492---370m" class="level3">
<h3 class="anchored" data-anchor-id="station-z0492---370m">Station Z0492 - 370m</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_Z0492-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_z0492-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="station-z0512---555m" class="level3">
<h3 class="anchored" data-anchor-id="station-z0512---555m">Station Z0512 - 555m</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_Z0512-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_z0512-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="station-z0503---715m" class="level3">
<h3 class="anchored" data-anchor-id="station-z0503---715m">Station Z0503 - 715m</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_Z0503-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_z0503-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="station-z0518---1000m" class="level3">
<h3 class="anchored" data-anchor-id="station-z0518---1000m">Station Z0518 - 1000m</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_Z0518-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_z0518-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="station-z0524---1010m" class="level3">
<h3 class="anchored" data-anchor-id="station-z0524---1010m">Station Z0524 - 1010m</h3>
<ul>
<li><p>Station sampled near the bottom (&lt;100m)</p></li>
<li><p><em>A. olfersii</em>: only 3 samples, ellipse not performed</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_Z0524-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_z0524-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="station-z0497---1335m" class="level3">
<h3 class="anchored" data-anchor-id="station-z0497---1335m">Station Z0497 - 1335m</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_Z0497-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/overlap_z0497-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cluster" class="level2">
<h2 class="anchored" data-anchor-id="cluster">cluster</h2>
<ul>
<li>cluster with the community-level overlap matrix as input (without depth division)</li>
</ul>
<p><strong>cluster 1</strong> :</p>
<ul>
<li>S. koefoedi &amp; M. argipalla, high overlap, same depth, same family</li>
<li>L. macdonaldi &amp; S. koefoedi : different depth distribution</li>
</ul>
<p><strong>cluster 2</strong>:</p>
<ul>
<li>N. kroyeri et N. bolini, same depth distribution, same family</li>
<li>N.kroyeri hada high overlap with M.atlanticum and Cyclothone but different depth distribution (same for N. bolini and M. atlanticum)</li>
<li>Cyclothone and M.atlanticum: not in the same depth layer (but same depth distribution)</li>
</ul>
<p><strong>cluster3</strong>:</p>
<ul>
<li>A. olfersii had a high overlap with L. crocodilus and M.punctatum (station at 1000 and 370m)</li>
<li>M.punctatum &amp; L.crocodilus: in the upper-mesopelagic assemblage (not in station)</li>
</ul>
<p><strong>cluster4</strong>:</p>
<ul>
<li>L. sphyrenoides &amp; A.risso: not the same depth distribution, same family</li>
</ul>
<p><strong>cluter 5</strong>:</p>
<ul>
<li>X. copei &amp; M. muelleri: not the same depth distribution</li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>elp.olp_community_mt <span class="ot">&lt;-</span> elp.olp_community<span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">"OverlapID"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(elp.olp_community_mt)) </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Elbow method</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># factoextra::fviz_nbclust(df, kmeans, method = "wss") +</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(subtitle = "Elbow method")</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Silhouette method</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># factoextra::fviz_nbclust(df, kmeans, method = "silhouette")+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(subtitle = "Silhouette method")</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Gap statistic</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># factoextra::fviz_nbclust(df, kmeans, nstart = 25, </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                          method = "gap_stat", nboot = 500, </span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                          verbose = FALSE)+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(subtitle = "Gap statistic method")</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>res.km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(df), <span class="dv">5</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># K-means clusters showing the group of each individuals</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#res.km$cluster</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_cluster</span>(res.km, <span class="at">data =</span> df, </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">palette=</span><span class="fu">c</span>(<span class="st">"#7b95cc"</span>, <span class="st">"#007A75"</span>, <span class="st">"#D96681"</span>, <span class="st">"#150578"</span>, <span class="st">"#BF9AD8"</span>),</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/cluster-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Dimension reduction using PCA</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># res.pca &lt;- prcomp(df,  scale = TRUE)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Coordinates of individuals</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ind.coord &lt;- as.data.frame(factoextra::get_pca_ind(res.pca)$coord)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Add clusters obtained using the K-means algorithm</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ind.coord$cluster &lt;- factor(res.km$cluster)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Add Species groups from the original data sett</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ind.coord$Species &lt;- df$Species</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Data inspection</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># head(ind.coord)</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # Percentage of variance explained by dimensions</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># eigenvalue &lt;- round(factoextra::get_eigenvalue(res.pca), 1)</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># variance.percent &lt;- eigenvalue$variance.percent</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># head(eigenvalue)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> isotope_data_fish<span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cluster=</span> <span class="fu">case_when</span>(species<span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Lampanyctus_macdonaldi"</span>, <span class="st">"Searsia_koefoedi"</span>, <span class="st">"Maulisia_argipalla"</span>) <span class="sc">~</span><span class="st">"A"</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                            species<span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Cyclothone"</span>, <span class="st">"Notoscopelus_bolini"</span>, <span class="st">"Notoscopelus_kroyeri"</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Melanostigma_atlanticum"</span>)<span class="sc">~</span><span class="st">"B"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                            species<span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Lampanyctus_crocodilus"</span>,<span class="st">"Argyropelecus_olfersii"</span>, </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Benthosema_glaciale"</span>, <span class="st">"Serrivomer_beanii"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Myctophum_punctatum"</span>)<span class="sc">~</span><span class="st">"C"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                            species<span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Arctozenus_risso"</span>, <span class="st">"Lestidiops_sphyrenoides"</span>)<span class="sc">~</span><span class="st">"D"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                            species<span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Xenodermichthys_copei"</span>, <span class="st">"Maurolicus_muelleri"</span>)<span class="sc">~</span><span class="st">"E"</span>))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>cluster_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> cluster_data, </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> d13c, </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> d15n)) <span class="sc">+</span> </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cluster, <span class="at">fill=</span>cluster), <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"#7b95cc"</span>, <span class="st">"#007A75"</span>, <span class="st">"#D96681"</span>, <span class="st">"#150578"</span>, <span class="st">"#BF9AD8"</span>))<span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#7b95cc"</span>, <span class="st">"#007A75"</span>, <span class="st">"#D96681"</span>, <span class="st">"#150578"</span>, <span class="st">"#BF9AD8"</span>))<span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">13</span><span class="sc">*</span>C<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">21</span>, <span class="sc">-</span><span class="fl">18.5</span>)) <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">15</span><span class="sc">*</span>N<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Ellipses</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># How big the ellipse </span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>p.ell <span class="ot">&lt;-</span> <span class="fl">0.40</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>ellipse_cluster <span class="ot">&lt;-</span> cluster_plot <span class="sc">+</span> </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> species, </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> cluster, </span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> cluster), </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.1</span>, </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> p.ell,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.8</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"norm"</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"polygon"</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ellipse_cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/cluster_niche-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution" class="level2">
<h2 class="anchored" data-anchor-id="distribution">Distribution</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="trophic_ecology_files/figure-html/density_plot-1.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section>
<section id="intraspecific-changes-over-the-depth-range-evolution-of-niche-area-kud-with-depth" class="level2">
<h2 class="anchored" data-anchor-id="intraspecific-changes-over-the-depth-range-evolution-of-niche-area-kud-with-depth">Intraspecific changes over the depth range ? Evolution of niche area (KUD) with depth</h2>
<section id="lampanyctus-crocodilus" class="level3">
<h3 class="anchored" data-anchor-id="lampanyctus-crocodilus">Lampanyctus crocodilus</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lamp_cro_niche <span class="ot">&lt;-</span> isotope_data_fish <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Lampanyctus_crocodilus"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>p.ell <span class="ot">&lt;-</span> <span class="fl">0.40</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lamp_cro_niche, <span class="fu">aes</span>(<span class="at">x =</span> d13c,<span class="at">y =</span> d15n)) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span><span class="fu">factor</span>(trawling_depth), <span class="at">shape=</span><span class="fu">factor</span>(trawling_depth)), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha=</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">13</span><span class="sc">*</span>C<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">21</span>, <span class="sc">-</span><span class="fl">18.5</span>)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">15</span><span class="sc">*</span>N<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_color_paletteer_d</span>(<span class="st">"LaCroixColoR::Pure"</span>)<span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_fill_paletteer_d</span>(<span class="st">"LaCroixColoR::Pure"</span>)<span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">factor</span>(trawling_depth), </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="fu">factor</span>(trawling_depth), </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="fu">factor</span>(trawling_depth)), </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.25</span>, </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> p.ell,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"norm"</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"polygon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_lamp_cro-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="calculate-vector-centroids" class="level4">
<h4 class="anchored" data-anchor-id="calculate-vector-centroids">Calculate vector (centroids)</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_lamp_centroid-1.png" class="img-fluid figure-img" width="1632"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="xenodermichthys-copei" class="level3">
<h3 class="anchored" data-anchor-id="xenodermichthys-copei">Xenodermichthys copei</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>xeno_cop_niche <span class="ot">&lt;-</span> isotope_data_fish <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Xenodermichthys_copei"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>p.ell <span class="ot">&lt;-</span> <span class="fl">0.40</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xeno_cop_niche, <span class="fu">aes</span>(<span class="at">x =</span> d13c,<span class="at">y =</span> d15n)) <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span><span class="fu">factor</span>(trawling_depth), <span class="at">shape=</span><span class="fu">factor</span>(trawling_depth)), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha=</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">13</span><span class="sc">*</span>C<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">21</span>, <span class="sc">-</span><span class="fl">18.5</span>)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">15</span><span class="sc">*</span>N<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_color_paletteer_d</span>(<span class="st">"LaCroixColoR::Pure"</span>)<span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_fill_paletteer_d</span>(<span class="st">"LaCroixColoR::Pure"</span>)<span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">factor</span>(trawling_depth), </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="fu">factor</span>(trawling_depth), </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="fu">factor</span>(trawling_depth)), </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.25</span>, </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> p.ell,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"norm"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"polygon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_xeno_cop-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="calculate-vector-centroids-1" class="level4">
<h4 class="anchored" data-anchor-id="calculate-vector-centroids-1">Calculate vector (centroids)</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 22
   Unobserved stochastic nodes: 3
   Total graph size: 37

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 20
   Unobserved stochastic nodes: 3
   Total graph size: 35

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 15
   Unobserved stochastic nodes: 3
   Total graph size: 30

Initializing model</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_xeno_cop_centroid-1.png" class="img-fluid figure-img" width="1632"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="argyropelecus-olfersii" class="level3">
<h3 class="anchored" data-anchor-id="argyropelecus-olfersii">Argyropelecus olfersii</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>argy_olf_niche <span class="ot">&lt;-</span> isotope_data_fish <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Argyropelecus_olfersii"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>p.ell <span class="ot">&lt;-</span> <span class="fl">0.40</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(argy_olf_niche, <span class="fu">aes</span>(<span class="at">x =</span> d13c,<span class="at">y =</span> d15n)) <span class="sc">+</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span><span class="fu">factor</span>(trawling_depth), <span class="at">shape=</span><span class="fu">factor</span>(trawling_depth)), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha=</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">13</span><span class="sc">*</span>C<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">21</span>, <span class="sc">-</span><span class="fl">18.5</span>)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">15</span><span class="sc">*</span>N<span class="sc">~</span><span class="st">'\u2030'</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_color_paletteer_d</span>(<span class="st">"LaCroixColoR::Pure"</span>)<span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  paletteer<span class="sc">::</span><span class="fu">scale_fill_paletteer_d</span>(<span class="st">"LaCroixColoR::Pure"</span>)<span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">factor</span>(trawling_depth), </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="fu">factor</span>(trawling_depth), </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="fu">factor</span>(trawling_depth)), </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.25</span>, </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> p.ell,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"norm"</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"polygon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_argy_olf-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="calculate-vector-centroids-2" class="level4">
<h4 class="anchored" data-anchor-id="calculate-vector-centroids-2">Calculate vector (centroids)</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 11
   Unobserved stochastic nodes: 3
   Total graph size: 26

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 11
   Unobserved stochastic nodes: 3
   Total graph size: 26

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 8
   Unobserved stochastic nodes: 3
   Total graph size: 23

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 3
   Unobserved stochastic nodes: 3
   Total graph size: 18

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 8
   Unobserved stochastic nodes: 3
   Total graph size: 23

Initializing model</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="trophic_ecology_files/figure-html/niche_argy_olf_centroid-1.png" class="img-fluid figure-img" width="1632"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>